insert into team_stats (
    team_name,  
    source_team_name, 
    season_start_year, 
    season_end_year, 
    assist_per_turnover_ratio, 
    assist_per_turnover_ratio_rank, 
    assists_per_fgm,  
    assists_per_fgm_rank,
    assists_per_game, 
    assists_per_game_rank, 
    assists_per_possession, 
    assists_per_possession_rank,
    average_1st_half_margin, 
    average_1st_half_margin_rank, 
    average_2nd_half_margin,
    average_2nd_half_margin_rank,
    average_overtime_margin, 
    average_overtime_margin_rank, 
    average_scoring_margin, 
    average_scoring_margin_rank,
    block_pct, 
    block_pct_rank, 
    blocks_per_game,
    blocks_per_game_rank,
    defensive_efficiency,
    defensive_efficiency_rank,
    defensive_rebounding_pct,
    defensive_rebounding_pct_rank,
    defensive_rebounds_per_game,
    defensive_rebounds_per_game_rank,
    effective_field_goal_pct,
    effective_field_goal_pct_rank,
    effective_possession_ratio,
    effective_possession_ratio_rank,
    extra_chances_per_game,
    extra_chances_per_game_rank,
    field_goals_attempted_per_game,
    field_goals_attempted_per_game_rank,
    field_goals_made_per_game,
    field_goals_made_per_game_rank,
    floor_percentage,
    floor_percentage_rank,
    free_throw_pct,
    free_throw_pct_rank,
    free_throw_rate,
    free_throw_rate_rank,
    free_throws_attempted_per_game,
    free_throws_attempted_per_game_rank,
    free_throws_made_per_game,
    free_throws_made_per_game_rank,
    fta_per_fga,
    fta_per_fga_rank,
    ftm_per_100_possessions,
    ftm_per_100_possessions_rank,
    games_played,
    games_played_rank,
    non_blocked_2_pt_pct,
    non_blocked_2_pt_pct_rank,
    offensive_efficiency,
    offensive_efficiency_rank,
    offensive_rebounding_pct,
    offensive_rebounding_pct_rank,
    offensive_rebounds_per_game,
    offensive_rebounds_per_game_rank,
    opponent_1st_half_points_per_game,
    opponent_1st_half_points_per_game_rank,
    opponent_2nd_half_points_per_game,
    opponent_2nd_half_points_per_game_rank,
    opponent_assist_per_turnover_ratio,
    opponent_assist_per_turnover_ratio_rank,
    opponent_assists_per_fgm,
    opponent_assists_per_fgm_rank,
    opponent_assists_per_game,
    opponent_assists_per_game_rank,
    opponent_assists_per_possession,
    opponent_assists_per_possession_rank,
    opponent_average_scoring_margin,
    opponent_average_scoring_margin_rank,
    opponent_block_pct,
    opponent_block_pct_rank,
    opponent_blocks_per_game,
    opponent_blocks_per_game_rank,
    opponent_defensive_rebounding_pct,
    opponent_defensive_rebounding_pct_rank,
    opponent_defensive_rebounds_per_game,
    opponent_defensive_rebounds_per_game_rank,
    opponent_effective_field_goal_pct,
    opponent_effective_field_goal_pct_rank,
    opponent_effective_possession_ratio,
    opponent_effective_possession_ratio_rank,
    opponent_field_goals_attempted_per_game,
    opponent_field_goals_attempted_per_game_rank,
    opponent_field_goals_made_per_game,
    opponent_field_goals_made_per_game_rank,
    opponent_floor_percentage,
    opponent_floor_percentage_rank,
    opponent_free_throw_pct,
    opponent_free_throw_pct_rank,
    opponent_free_throw_rate,
    opponent_free_throw_rate_rank,
    opponent_free_throws_attempted_per_game,
    opponent_free_throws_attempted_per_game_rank,
    opponent_free_throws_made_per_game,
    opponent_free_throws_made_per_game_rank,
    opponent_fta_per_fga,
    opponent_fta_per_fga_rank,
    opponent_ftm_per_100_possessions,
    opponent_ftm_per_100_possessions_rank,
    opponent_non_blocked_2_pt_pct,
    opponent_non_blocked_2_pt_pct_rank,
    opponent_offensive_rebounding_pct,
    opponent_offensive_rebounding_pct_rank,
    opponent_offensive_rebounds_per_game,
    opponent_offensive_rebounds_per_game_rank,
    opponent_overtime_points_per_game,
    opponent_overtime_points_per_game_rank,
    opponent_percent_of_points_from_2_pointers,
    opponent_percent_of_points_from_2_pointers_rank,
    opponent_percent_of_points_from_3_pointers,
    opponent_percent_of_points_from_3_pointers_rank,
    opponent_percent_of_points_from_free_throws,
    opponent_percent_of_points_from_free_throws_rank,
    opponent_personal_foul_pct,
    opponent_personal_foul_pct_rank,
    opponent_personal_fouls_per_game,
    opponent_personal_fouls_per_game_rank,
    opponent_personal_fouls_per_possession,
    opponent_personal_fouls_per_possession_rank,
    opponent_points_from_2_pointers,
    opponent_points_from_2_pointers_rank,
    opponent_points_from_3_pointers,
    opponent_points_from_3_pointers_rank,
    opponent_points_per_game,
    opponent_points_per_game_rank,
    opponent_shooting_pct,
    opponent_shooting_pct_rank,
    opponent_steal_pct,
    opponent_steal_pct_rank,
    opponent_steals_per_game,
    opponent_steals_per_game_rank,
    opponent_steals_perpossession,
    opponent_steals_perpossession_rank,
    opponent_team_rebounds_per_game,
    opponent_team_rebounds_per_game_rank,
    opponent_three_point_pct,
    opponent_three_point_pct_rank,
    opponent_three_point_rate,
    opponent_three_point_rate_rank,
    opponent_three_pointers_attempted_per_game,
    opponent_three_pointers_attempted_per_game_rank,
    opponent_three_pointers_made_per_game,
    opponent_three_pointers_made_per_game_rank,
    opponent_total_rebounds_per_game,
    opponent_total_rebounds_per_game_rank,
    opponent_true_shooting_percentage,
    opponent_true_shooting_percentage_rank,
    opponent_turnover_pct,
    opponent_turnover_pct_rank,
    opponent_turnovers_per_game,
    opponent_turnovers_per_game_rank,
    opponent_turnovers_per_possession,
    opponent_turnovers_per_possession_rank,
    opponent_two_point_pct,
    opponent_two_point_pct_rank,
    opponent_two_point_rate,
    opponent_two_point_rate_rank,
    opponent_win_pct_all_games,
    opponent_win_pct_all_games_rank,
    opponent_win_pct_close_games,
    opponent_win_pct_close_games_rank,
    overtime_points_per_game,
    overtime_points_per_game_rank,
    percent_of_points_from_2_pointers,
    percent_of_points_from_2_pointers_rank,
    percent_of_points_from_3_pointers,
    percent_of_points_from_3_pointers_rank,
    percent_of_points_from_free_throws,
    percent_of_points_from_free_throws_rank,
    personal_foul_pct,
    personal_foul_pct_rank,
    personal_fouls_per_game,
    personal_fouls_per_game_rank,
    personal_fouls_per_possession,
    personal_fouls_per_possession_rank,
    points_from_2_pointers,
    points_from_2_pointers_rank,
    points_from_3_pointers,
    points_from_3_pointers_rank,
    points_per_game,
    points_per_game_rank,
    possessions_per_game,
    possessions_per_game_rank,
    shooting_pct,
    shooting_pct_rank,
    steal_pct,
    steal_pct_rank,
    steals_per_game,
    steals_per_game_rank,
    steals_perpossession,
    steals_perpossession_rank,
    team_rebounds_per_game,
    team_rebounds_per_game_rank,
    three_point_pct,
    three_point_pct_rank,
    three_point_rate,
    three_point_rate_rank,
    three_pointers_attempted_per_game,
    three_pointers_attempted_per_game_rank,
    three_pointers_made_per_game,
    three_pointers_made_per_game_rank,
    total_rebounding_percentage,
    total_rebounding_percentage_rank,
    total_rebounds_per_game,
    total_rebounds_per_game_rank,
    true_shooting_percentage,
    true_shooting_percentage_rank,
    turnover_pct,
    turnover_pct_rank,
    turnovers_per_game,
    turnovers_per_game_rank,
    turnovers_per_possession,
    turnovers_per_possession_rank,
    two_point_pct,
    two_point_pct_rank,
    two_point_rate,
    two_point_rate_rank,
    win_pct_all_games,
    win_pct_all_games_rank,
    win_pct_close_games,
    win_pct_close_games_rank)
select
        ifnull(map.new_name, ts.team) as team_name,   
        ts.team as source_team_name, 
        year, 
        year + 1,
        assist_per_turnover_ratio, 
        assist_per_turnover_ratio_rank, 
        assists_per_fgm,  
        assists_per_fgm_rank,
        assists_per_game, 
        assists_per_game_rank, 
        assists_per_possession, 
        assists_per_possession_rank,
        average_1st_half_margin, 
        average_1st_half_margin_rank, 
        average_2nd_half_margin,
        average_2nd_half_margin_rank,
        average_overtime_margin, 
        average_overtime_margin_rank, 
        average_scoring_margin, 
        average_scoring_margin_rank,
        block_pct, 
        block_pct_rank, 
        blocks_per_game,
        blocks_per_game_rank,
        defensive_efficiency,
        defensive_efficiency_rank,
        defensive_rebounding_pct,
        defensive_rebounding_pct_rank,
        defensive_rebounds_per_game,
        defensive_rebounds_per_game_rank,
        effective_field_goal_pct,
        effective_field_goal_pct_rank,
        effective_possession_ratio,
        effective_possession_ratio_rank,
        extra_chances_per_game,
        extra_chances_per_game_rank,
        field_goals_attempted_per_game,
        field_goals_attempted_per_game_rank,
        field_goals_made_per_game,
        field_goals_made_per_game_rank,
        floor_percentage,
        floor_percentage_rank,
        free_throw_pct,
        free_throw_pct_rank,
        free_throw_rate,
        free_throw_rate_rank,
        free_throws_attempted_per_game,
        free_throws_attempted_per_game_rank,
        free_throws_made_per_game,
        free_throws_made_per_game_rank,
        fta_per_fga,
        fta_per_fga_rank,
        ftm_per_100_possessions,
        ftm_per_100_possessions_rank,
        games_played,
        games_played_rank,
        non_blocked_2_pt_pct,
        non_blocked_2_pt_pct_rank,
        offensive_efficiency,
        offensive_efficiency_rank,
        offensive_rebounding_pct,
        offensive_rebounding_pct_rank,
        offensive_rebounds_per_game,
        offensive_rebounds_per_game_rank,
        opponent_1st_half_points_per_game,
        opponent_1st_half_points_per_game_rank,
        opponent_2nd_half_points_per_game,
        opponent_2nd_half_points_per_game_rank,
        opponent_assist_per_turnover_ratio,
        opponent_assist_per_turnover_ratio_rank,
        opponent_assists_per_fgm,
        opponent_assists_per_fgm_rank,
        opponent_assists_per_game,
        opponent_assists_per_game_rank,
        opponent_assists_per_possession,
        opponent_assists_per_possession_rank,
        opponent_average_scoring_margin,
        opponent_average_scoring_margin_rank,
        opponent_block_pct,
        opponent_block_pct_rank,
        opponent_blocks_per_game,
        opponent_blocks_per_game_rank,
        opponent_defensive_rebounding_pct,
        opponent_defensive_rebounding_pct_rank,
        opponent_defensive_rebounds_per_game,
        opponent_defensive_rebounds_per_game_rank,
        opponent_effective_field_goal_pct,
        opponent_effective_field_goal_pct_rank,
        opponent_effective_possession_ratio,
        opponent_effective_possession_ratio_rank,
        opponent_field_goals_attempted_per_game,
        opponent_field_goals_attempted_per_game_rank,
        opponent_field_goals_made_per_game,
        opponent_field_goals_made_per_game_rank,
        opponent_floor_percentage,
        opponent_floor_percentage_rank,
        opponent_free_throw_pct,
        opponent_free_throw_pct_rank,
        opponent_free_throw_rate,
        opponent_free_throw_rate_rank,
        opponent_free_throws_attempted_per_game,
        opponent_free_throws_attempted_per_game_rank,
        opponent_free_throws_made_per_game,
        opponent_free_throws_made_per_game_rank,
        opponent_fta_per_fga,
        opponent_fta_per_fga_rank,
        opponent_ftm_per_100_possessions,
        opponent_ftm_per_100_possessions_rank,
        opponent_non_blocked_2_pt_pct,
        opponent_non_blocked_2_pt_pct_rank,
        opponent_offensive_rebounding_pct,
        opponent_offensive_rebounding_pct_rank,
        opponent_offensive_rebounds_per_game,
        opponent_offensive_rebounds_per_game_rank,
        opponent_overtime_points_per_game,
        opponent_overtime_points_per_game_rank,
        opponent_percent_of_points_from_2_pointers,
        opponent_percent_of_points_from_2_pointers_rank,
        opponent_percent_of_points_from_3_pointers,
        opponent_percent_of_points_from_3_pointers_rank,
        opponent_percent_of_points_from_free_throws,
        opponent_percent_of_points_from_free_throws_rank,
        opponent_personal_foul_pct,
        opponent_personal_foul_pct_rank,
        opponent_personal_fouls_per_game,
        opponent_personal_fouls_per_game_rank,
        opponent_personal_fouls_per_possession,
        opponent_personal_fouls_per_possession_rank,
        opponent_points_from_2_pointers,
        opponent_points_from_2_pointers_rank,
        opponent_points_from_3_pointers,
        opponent_points_from_3_pointers_rank,
        opponent_points_per_game,
        opponent_points_per_game_rank,
        opponent_shooting_pct,
        opponent_shooting_pct_rank,
        opponent_steal_pct,
        opponent_steal_pct_rank,
        opponent_steals_per_game,
        opponent_steals_per_game_rank,
        opponent_steals_perpossession,
        opponent_steals_perpossession_rank,
        opponent_team_rebounds_per_game,
        opponent_team_rebounds_per_game_rank,
        opponent_three_point_pct,
        opponent_three_point_pct_rank,
        opponent_three_point_rate,
        opponent_three_point_rate_rank,
        opponent_three_pointers_attempted_per_game,
        opponent_three_pointers_attempted_per_game_rank,
        opponent_three_pointers_made_per_game,
        opponent_three_pointers_made_per_game_rank,
        opponent_total_rebounds_per_game,
        opponent_total_rebounds_per_game_rank,
        opponent_true_shooting_percentage,
        opponent_true_shooting_percentage_rank,
        opponent_turnover_pct,
        opponent_turnover_pct_rank,
        opponent_turnovers_per_game,
        opponent_turnovers_per_game_rank,
        opponent_turnovers_per_possession,
        opponent_turnovers_per_possession_rank,
        opponent_two_point_pct,
        opponent_two_point_pct_rank,
        opponent_two_point_rate,
        opponent_two_point_rate_rank,
        opponent_win_pct_all_games,
        opponent_win_pct_all_games_rank,
        opponent_win_pct_close_games,
        opponent_win_pct_close_games_rank,
        overtime_points_per_game,
        overtime_points_per_game_rank,
        percent_of_points_from_2_pointers,
        percent_of_points_from_2_pointers_rank,
        percent_of_points_from_3_pointers,
        percent_of_points_from_3_pointers_rank,
        percent_of_points_from_free_throws,
        percent_of_points_from_free_throws_rank,
        personal_foul_pct,
        personal_foul_pct_rank,
        personal_fouls_per_game,
        personal_fouls_per_game_rank,
        personal_fouls_per_possession,
        personal_fouls_per_possession_rank,
        points_from_2_pointers,
        points_from_2_pointers_rank,
        points_from_3_pointers,
        points_from_3_pointers_rank,
        points_per_game,
        points_per_game_rank,
        possessions_per_game,
        possessions_per_game_rank,
        shooting_pct,
        shooting_pct_rank,
        steal_pct,
        steal_pct_rank,
        steals_per_game,
        steals_per_game_rank,
        steals_perpossession,
        steals_perpossession_rank,
        team_rebounds_per_game,
        team_rebounds_per_game_rank,
        three_point_pct,
        three_point_pct_rank,
        three_point_rate,
        three_point_rate_rank,
        three_pointers_attempted_per_game,
        three_pointers_attempted_per_game_rank,
        three_pointers_made_per_game,
        three_pointers_made_per_game_rank,
        total_rebounding_percentage,
        total_rebounding_percentage_rank,
        total_rebounds_per_game,
        total_rebounds_per_game_rank,
        true_shooting_percentage,
        true_shooting_percentage_rank,
        turnover_pct,
        turnover_pct_rank,
        turnovers_per_game,
        turnovers_per_game_rank,
        turnovers_per_possession,
        turnovers_per_possession_rank,
        two_point_pct,
        two_point_pct_rank,
        two_point_rate,
        two_point_rate_rank,
        win_pct_all_games,
        win_pct_all_games_rank,
        win_pct_close_games,
        win_pct_close_games_rank
from <<!table_name>> ts left outer join team_name_map map on ts.team = map.old_name;